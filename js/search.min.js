"use strict";var index=new FlexSearch.Index({tokenize:"forward"});recipe_data.recipes.forEach(({name:t},e)=>{index.add(e,t)}),document.addEventListener("DOMContentLoaded",()=>{installServiceWorker(),customElements.define("recipe-card",RecipeCard,{extends:"a"});let t=document.querySelector("#category-btn");t.disabled=!1;let e=document.querySelector("#dialog-category");t.addEventListener("click",()=>{e.showModal()}),e.querySelectorAll(".checkbox > input").forEach(n=>{n.addEventListener("change",displayCategoryFilter)});let c=document.querySelector("#cuisine-btn");c.disabled=!1;let a=document.querySelector("#dialog-cuisine");c.addEventListener("click",()=>{a.showModal()}),a.querySelectorAll(".checkbox").forEach(n=>{n.addEventListener("change",displayCuisineFilter)});let o=document.querySelector("#diet-btn");o.disabled=!1;let i=document.querySelector("#dialog-diet");o.addEventListener("click",()=>{i.showModal()}),i.querySelectorAll(".checkbox").forEach(n=>{n.addEventListener("change",displayDietFilter)});let s=document.querySelector("#tag-btn");s.disabled=!1;let d=document.querySelector("#dialog-tag");s.addEventListener("click",()=>{d.showModal()}),d.querySelectorAll(".checkbox").forEach(n=>{n.addEventListener("change",displayTagFilter)});let u=document.querySelector("#name-btn");u.disabled=!1;let h=document.querySelector("#dialog-name"),g=h.querySelector("#search-name");u.addEventListener("click",()=>{h.showModal(),g.focus({preventScroll:!0})}),g.addEventListener("input",displayNameFilter);let m=document.querySelector("#source-btn");m.disabled=!1;let p=document.querySelector("#dialog-source"),f=p.querySelector("#search-source");m.addEventListener("click",()=>{p.showModal(),f.focus({preventScroll:!0})}),f.addEventListener("input",displaySourceFilter),document.querySelectorAll("dialog").forEach(n=>{n.addEventListener("click",S=>{S.target.nodeName==="DIALOG"&&(storeSearch("",[]),n.close("cancel"))})}),document.querySelectorAll("dialog .dialog-header button").forEach(n=>{n.addEventListener("click",closeDialog)}),updateCacheButton(),document.querySelector("#cache-site-btn").addEventListener("click",()=>{cacheSite(recipe_data.recipes)});let y=document.querySelector("#theme-btn");y.disabled=!1,y.addEventListener("click",toggleTheme),localStorage.getItem("light-theme")=="true"&&toggleTheme(),restoreSearch()});class RecipeCard extends HTMLAnchorElement{constructor(e){super();const l='<svg xmlns="http://www.w3.org/2000/svg" class="label-icon" viewBox="0 0 100 100"><circle cx="50" cy="50" r="45" fill="none" stroke="var(--fg)" stroke-width="10"/><path stroke="var(--fg)" fill="none" stroke-width="10" d="M50 15v35l25 25"/></svg>',c='<svg xmlns="http://www.w3.org/2000/svg" class="label-icon" viewBox="0 0 60 90"><g fill="var(--fg)"><path d="M26.814 21.33c0-10.2-6.003-21.3-13.407-21.3C6.002.03 0 11.13 0 21.33c0 6.429 2.387 10.96 6.006 13.433 2.262 1.546 3.647 4.075 3.599 6.814l-.76 43.582c-.042 2.419 1.717 4.6 4.126 4.824a4.568 4.568 0 005.003-4.626l-.764-43.78c-.048-2.739 1.338-5.268 3.599-6.814 3.618-2.474 6.005-7.004 6.005-13.433zM60.983 29.703L60.219.973a1 1 0 00-1-.973h-2.222a1 1 0 00-1 1v24.127a1 1 0 01-1 1h-1.915a1 1 0 01-1-1V1a1 1 0 00-1-1h-2.297a1 1 0 00-1 1v24.127a1 1 0 01-1 1H44.87a1 1 0 01-1-1V1a1 1 0 00-1-1h-2.222a1 1 0 00-1 .973l-.764 28.73a3.999 3.999 0 002.961 3.969l2.14.575a2.998 2.998 0 012.221 2.95l-.84 48.159a4.566 4.566 0 109.132 0l-.84-48.159a3.001 3.001 0 012.221-2.95l2.14-.575a3.998 3.998 0 002.964-3.969z"/></g></svg>',a='<svg xmlns="http://www.w3.org/2000/svg" class="label-icon" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8 1.314C12.438-3.248 23.534 4.735 8 15-7.534 4.736 3.562-3.248 8 1.314z"/></svg>',r=document.createElement("h2");if(r.style.setProperty("--bg-img",`url('${e.image}')`),r.innerText=e.name,r.appendChild(this.newLabel(l+`
`+e.time)),r.appendChild(this.newLabel(c+`
Serves `+e.yield)),e.positive){let o=document.createElement("span");o.classList.add("recipe-heart"),o.innerHTML=a,r.appendChild(o)}this.href=e.html,this.appendChild(r)}newLabel(e){const l=document.createElement("span");return l.innerHTML=e,l.classList.add("recipe-label"),l}}function installServiceWorker(){"serviceWorker"in navigator?(console.log("CLIENT: service worker registration in progress."),navigator.serviceWorker.register("/service-worker.min.js").then(function(){console.log("CLIENT: service worker registration complete.")},function(){console.log("CLIENT: service worker registration failure.")})):console.log("CLIENT: service worker is not supported.")}function closeDialog(t){let l=t.target.closest("dialog");storeSearch("",[]),l.close()}function displayResults(t,e){let l=e.cloneNode(!1);for(let c of t){let a=new RecipeCard(c);a.classList.add("search-result"),l.appendChild(a)}e.parentNode.replaceChild(l,e)}function clearResults(t){let e=t.cloneNode(!1);t.parentNode.replaceChild(e,t)}function displayCategoryFilter(){let e=[...document.querySelectorAll("#dialog-category input:checked")].map(l=>l.value);if(storeSearch("#dialog-category",e),e.length>0){let l=recipe_data.recipes.filter(c=>e.includes(c.category));displayResults(l,document.querySelector("#result-category"))}else clearResults(document.querySelector("#result-category"))}function displayCuisineFilter(){let e=[...document.querySelectorAll("#dialog-cuisine input:checked")].map(l=>l.value);if(storeSearch("#dialog-cuisine",e),e.length>0){let l=recipe_data.recipes.filter(c=>e.filter(r=>c.cuisine.includes(r)).length>0);displayResults(l,document.querySelector("#result-cuisine"))}else clearResults(document.querySelector("#result-cuisine"))}function displayDietFilter(){let e=[...document.querySelectorAll("#dialog-diet input:checked")].map(l=>l.value);if(storeSearch("#dialog-diet",e),e.length>0){let l=recipe_data.recipes.filter(c=>e.filter(r=>c.diet.includes(r)).length>0);displayResults(l,document.querySelector("#result-diet"))}else clearResults(document.querySelector("#result-diet"))}function displayTagFilter(){let e=[...document.querySelectorAll("#dialog-tag input:checked")].map(l=>l.value);if(storeSearch("#dialog-tag",e),e.length>0){let l=recipe_data.recipes.filter(c=>e.filter(r=>c.tags.includes(r)).length>0);displayResults(l,document.querySelector("#result-tag"))}else clearResults(document.querySelector("#result-tag"))}function displayNameFilter(){let t=document.querySelector("#search-name").value;if(storeSearch("#dialog-name",[t]),t.length>0){let l=index.search(t,20).map(c=>recipe_data.recipes[c]);displayResults(l,document.querySelector("#result-name"))}else clearResults(document.querySelector("#result-name"))}function displaySourceFilter(){let t=document.querySelector("#search-source").value;if(storeSearch("#dialog-source",[t]),t.length>0){var e=recipe_data.recipes.filter(l=>l.source.includes(t));displayResults(e,document.querySelector("#result-source"))}else clearResults(document.querySelector("#result-source"))}var CacheStatus;(function(t){t[t.None=0]="None",t[t.Update=1]="Update",t[t.Current=2]="Current"})(CacheStatus||(CacheStatus={}));function checkOfflineCacheStatus(){let t=localStorage.getItem("last-update-hash");return t==null?CacheStatus.None:document.querySelector("meta[name='update-hash']").content!=t?CacheStatus.Update:CacheStatus.Current}function cacheSite(t){let e=t.map(l=>[l.html,l.image]).flat();e.push("/js/search_data.min.js"),e.push("/all-recipes"),e.push("/random"),caches.keys().then(l=>l[l.length-1]).then(l=>{caches.open(l).then(c=>{c.addAll(e)})}).then(()=>{let l=document.querySelector("meta[name='update-hash']");localStorage.setItem("last-update-hash",l.content),updateCacheButton()})}async function updateCacheButton(){let e=(await navigator.storage.estimate()).quota,l=Number(document.querySelector("meta[name='cache-size']").content);if(l>e)return;let c=document.querySelector("#cache-site-btn"),a=Math.ceil(l/1e6).toString(),r=checkOfflineCacheStatus();r==CacheStatus.None?(c.innerHTML=`Cache site<br><span class="light-text">${a} MB</span>`,c.disabled=!1):r==CacheStatus.Update?(c.innerHTML=`Update cache<br><span class="light-text">${a} MB</span>`,c.disabled=!1):(c.innerHTML="Available<br>offline",c.disabled=!0)}function toggleTheme(){let t=document.querySelector("html");t.classList.toggle("light-theme");let e=document.querySelector("#theme-btn .light-text");t.classList.contains("light-theme")?(localStorage.setItem("light-theme","true"),e.innerText="Light"):(localStorage.setItem("light-theme","false"),e.innerText="Dark")}function storeSearch(t,e){sessionStorage.setItem("search-modalID",t),sessionStorage.setItem("search-values",JSON.stringify(e))}function restoreSearch(){let t=sessionStorage.getItem("search-modalID");if(t==null||t=="")return;let e=JSON.parse(sessionStorage.getItem("search-values"));if(e==null||e.length==0)return;let l=document.querySelector(t);if(l.showModal(),t=="#dialog-name"||t=="#dialog-source"){let c=l.querySelector("input");c.value=e[0],c.dispatchEvent(new Event("input"))}else{for(const c of e){let a=l.querySelector(`input[value="${c}"`);a.checked=!0}switch(t){case"#dialog-category":displayCategoryFilter();break;case"#dialog-cuisine":displayCuisineFilter();break;case"#dialog-diet":displayDietFilter();break;case"#dialog-tag":displayTagFilter();break}}}
