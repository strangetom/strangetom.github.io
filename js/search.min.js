"use strict";var index=new FlexSearch.Index({tokenize:"forward"});recipe_data.recipes.forEach(({name:l},e)=>{index.add(e,l)});var PaneSize=(t=>(t[t.Close=0]="Close",t[t.Minimise=1]="Minimise",t[t.Open=2]="Open",t))(PaneSize||{}),paneState=0;document.addEventListener("DOMContentLoaded",()=>{customElements.define("recipe-card",RecipeCard,{extends:"a"}),document.querySelector("#search form").addEventListener("submit",search),document.querySelector("#close-search-results").addEventListener("click",()=>{paneState==2?setResultsPaneSize(1):setResultsPaneSize(0)}),document.querySelector("#search-results-header h2").addEventListener("click",()=>{paneState==2?setResultsPaneSize(1):setResultsPaneSize(2)}),document.querySelector("#search-box").addEventListener("click",()=>{paneState==2&&setResultsPaneSize(1)}),document.querySelector("#clear-filters").addEventListener("click",()=>{let i=document.querySelectorAll("#search-filters input:checked");for(const c of i)c.checked=!1})});class RecipeCard extends HTMLAnchorElement{constructor(e){super();const s=document.createElement("h3");s.innerText=e.name;const t=document.createElement("img");t.src=`/images/${e.slug}.webp`,t.addEventListener("error",()=>{t.src="/img/placeholder.webp"}),this.href=`/recipes/${e.slug}`,this.classList.add("search-result"),this.appendChild(t),this.appendChild(s)}}function search(l){l.preventDefault();let e=[...document.querySelectorAll("#search-filters input:checked")].map(n=>n.value),s=document.querySelector("#search-box").value,t;s===""?t=recipe_data.recipes:t=index.search(s,20).map(r=>recipe_data.recipes[r]);let o=t.filter(n=>{let r,a;for(const u of e){if([r,a]=u.split("/"),!n.hasOwnProperty(r))return!1;if(r.endsWith("s")){if(!n[r].includes(a))return!1}else if(n[r]!==a)return!1}return!0}),i=document.querySelector("#search-results-list"),c=i.cloneNode(!1);for(const n of o){let r=new RecipeCard(n);c.appendChild(r)}i.parentElement.replaceChild(c,i);let d=document.querySelector("#search-results-filters");e.length>0?d.innerHTML=e.join("&nbsp;&nbsp;&nbsp;&nbsp;"):d.innerHTML="",setResultsPaneSize(2)}function setResultsPaneSize(l){let e=document.querySelector("#search-results"),s=e.querySelector("#search-results-header svg");switch(l){case 0:e.style.height="0",e.style.overflowY="",s.classList.remove("rotate"),paneState=0;break;case 1:e.style.height="4rem",e.style.overflowY="hidden",s.classList.remove("rotate"),paneState=1;break;case 2:e.style.height="calc(100svh - 125px)",e.style.overflowY="",s.classList.add("rotate"),paneState=2;break}}
