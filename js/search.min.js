"use strict";var index=new FlexSearch.Index({tokenize:"forward"});recipe_data.recipes.forEach(({name:l},e)=>{index.add(e,l)});var PaneSize=(t=>(t[t.Close=0]="Close",t[t.Minimise=1]="Minimise",t[t.Open=2]="Open",t))(PaneSize||{}),paneState=0;document.addEventListener("DOMContentLoaded",()=>{customElements.define("recipe-card",RecipeCard,{extends:"a"}),document.querySelector("#search form").addEventListener("submit",search),document.querySelector("#close-search-results").addEventListener("click",()=>{paneState==2?setResultsPaneSize(1):setResultsPaneSize(0)}),document.querySelector("#search-results-header h2").addEventListener("click",()=>{paneState==2?setResultsPaneSize(1):setResultsPaneSize(2)}),document.querySelector("#search-box").addEventListener("click",()=>{paneState==2&&setResultsPaneSize(1)}),document.querySelector("#clear-filters").addEventListener("click",()=>{let a=document.querySelectorAll("#search-filters input:checked");for(const c of a)c.checked=!1})});class RecipeCard extends HTMLAnchorElement{constructor(e){super();const s=document.createElement("h3");s.innerText=e.name;const t=document.createElement("img");if(t.src=`/images/${e.slug}.webp`,t.addEventListener("error",()=>{t.src="/img/placeholder.webp"}),this.href=`/recipes/${e.slug}`,this.classList.add("search-result"),this.appendChild(t),this.appendChild(s),e.positive){let i=document.createElement("span");i.classList.add("recipe-heart"),i.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"> <path fill-rule="evenodd" d="M8 1.314C12.438-3.248 23.534 4.735 8 15-7.534 4.736 3.562-3.248 8 1.314z"></path></svg>',this.append(i)}}}function search(l){l.preventDefault();let e=[...document.querySelectorAll("#search-filters input:checked")].map(n=>n.value),s=document.querySelector("#search-box").value,t;s===""?t=recipe_data.recipes:t=index.search(s,20).map(r=>recipe_data.recipes[r]);let i=t.filter(n=>{let r,o;for(const u of e){if([r,o]=u.split("/"),!n.hasOwnProperty(r))return!1;if(r.endsWith("s")){if(!n[r].includes(o))return!1}else if(n[r]!==o)return!1}return!0}),a=document.querySelector("#search-results-list"),c=a.cloneNode(!1);for(const n of i){let r=new RecipeCard(n);c.appendChild(r)}a.parentElement.replaceChild(c,a);let d=document.querySelector("#search-results-filters");e.length>0?d.innerHTML=e.join("&nbsp;&nbsp;&nbsp;&nbsp;"):d.innerHTML="",setResultsPaneSize(2)}function setResultsPaneSize(l){let e=document.querySelector("#search-results"),s=e.querySelector("#search-results-header svg");switch(l){case 0:e.style.height="0",e.style.overflowY="",s.classList.remove("rotate"),paneState=0;break;case 1:e.style.height="4rem",e.style.overflowY="hidden",s.classList.remove("rotate"),paneState=1;break;case 2:e.style.height="calc(100svh - 125px)",e.style.overflowY="",s.classList.add("rotate"),paneState=2;break}}
