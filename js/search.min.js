"use strict";var index=new FlexSearch.Index({tokenize:"forward"});recipe_data.recipes.forEach(({name:t},e)=>{index.add(e,t)}),document.addEventListener("DOMContentLoaded",()=>{installServiceWorker(),customElements.define("recipe-card",RecipeCard,{extends:"a"});let t=document.querySelector("#category-btn");t.disabled=!1;let e=document.querySelector("#dialog-category");t.addEventListener("click",()=>{e.showModal()}),e.querySelectorAll(".checkbox > input").forEach(i=>{i.addEventListener("change",displayCategoryFilter)});let n=document.querySelector("#cuisine-btn");n.disabled=!1;let r=document.querySelector("#dialog-cuisine");n.addEventListener("click",()=>{r.showModal()}),r.querySelectorAll(".checkbox").forEach(i=>{i.addEventListener("change",displayCuisineFilter)});let c=document.querySelector("#ingredients-btn");c.disabled=!1;let o=document.querySelector("#dialog-ingredients"),s=o.querySelector("#search-ingredients");c.addEventListener("click",()=>{o.showModal(),s.focus({preventScroll:!0})}),s.addEventListener("input",addIngredientToFilter);let d=document.querySelector("#tag-btn");d.disabled=!1;let u=document.querySelector("#dialog-tag");d.addEventListener("click",()=>{u.showModal()}),u.querySelectorAll(".checkbox").forEach(i=>{i.addEventListener("change",displayTagFilter)});let h=document.querySelector("#name-btn");h.disabled=!1;let g=document.querySelector("#dialog-name"),m=g.querySelector("#search-name");h.addEventListener("click",()=>{g.showModal(),m.focus({preventScroll:!0})}),m.addEventListener("input",displayNameFilter);let p=document.querySelector("#source-btn");p.disabled=!1;let f=document.querySelector("#dialog-source"),L=f.querySelector("#search-source");p.addEventListener("click",()=>{f.showModal(),L.focus({preventScroll:!0})}),L.addEventListener("input",displaySourceFilter),document.querySelectorAll("dialog").forEach(i=>{i.addEventListener("click",v=>{v.target.nodeName==="DIALOG"&&(storeSearch("",[]),i.close("cancel"))})}),document.querySelectorAll("dialog .dialog-header button").forEach(i=>{i.addEventListener("click",closeDialog)}),updateCacheButton(),document.querySelector("#cache-site-btn").addEventListener("click",()=>{cacheSite(recipe_data.recipes)});let S=document.querySelector("#theme-btn");S.disabled=!1,S.addEventListener("click",toggleTheme);let y=localStorage.getItem("light-theme");y==null?applyTheme("Auto"):y=="true"?applyTheme("Light"):applyTheme("Dark"),restoreSearch()});class RecipeCard extends HTMLAnchorElement{constructor(e){super();const l='<svg xmlns="http://www.w3.org/2000/svg" class="label-icon" viewBox="0 0 100 100"><circle cx="50" cy="50" r="45" fill="none" stroke="var(--fg)" stroke-width="10"/><path stroke="var(--fg)" fill="none" stroke-width="10" d="M50 15v35l25 25"/></svg>',n='<svg xmlns="http://www.w3.org/2000/svg" class="label-icon" viewBox="0 0 60 90"><g fill="var(--fg)"><path d="M26.814 21.33c0-10.2-6.003-21.3-13.407-21.3C6.002.03 0 11.13 0 21.33c0 6.429 2.387 10.96 6.006 13.433 2.262 1.546 3.647 4.075 3.599 6.814l-.76 43.582c-.042 2.419 1.717 4.6 4.126 4.824a4.568 4.568 0 005.003-4.626l-.764-43.78c-.048-2.739 1.338-5.268 3.599-6.814 3.618-2.474 6.005-7.004 6.005-13.433zM60.983 29.703L60.219.973a1 1 0 00-1-.973h-2.222a1 1 0 00-1 1v24.127a1 1 0 01-1 1h-1.915a1 1 0 01-1-1V1a1 1 0 00-1-1h-2.297a1 1 0 00-1 1v24.127a1 1 0 01-1 1H44.87a1 1 0 01-1-1V1a1 1 0 00-1-1h-2.222a1 1 0 00-1 .973l-.764 28.73a3.999 3.999 0 002.961 3.969l2.14.575a2.998 2.998 0 012.221 2.95l-.84 48.159a4.566 4.566 0 109.132 0l-.84-48.159a3.001 3.001 0 012.221-2.95l2.14-.575a3.998 3.998 0 002.964-3.969z"/></g></svg>',r='<svg xmlns="http://www.w3.org/2000/svg" class="label-icon" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8 1.314C12.438-3.248 23.534 4.735 8 15-7.534 4.736 3.562-3.248 8 1.314z"/></svg>',a=document.createElement("h2");if(a.style.setProperty("--bg-img",`url('/images/${e.slug}.webp')`),a.innerText=e.name,a.appendChild(this.newLabel(l+`
`+e.time)),a.appendChild(this.newLabel(n+`
Serves `+e.yield)),e?.positive){let c=document.createElement("span");c.classList.add("recipe-heart"),c.innerHTML=r,a.appendChild(c)}this.href=`/recipes/${e.slug}`,this.appendChild(a)}newLabel(e){const l=document.createElement("span");return l.innerHTML=e,l.classList.add("recipe-label"),l}}function installServiceWorker(){"serviceWorker"in navigator?(console.log("CLIENT: service worker registration in progress."),navigator.serviceWorker.register("/service-worker.min.js").then(function(){console.log("CLIENT: service worker registration complete.")},function(){console.log("CLIENT: service worker registration failure.")})):console.log("CLIENT: service worker is not supported.")}function closeDialog(t){let l=t.target.closest("dialog");storeSearch("",[]),l.close()}function displayResults(t,e){let l=e.cloneNode(!1);for(let n of t){let r=new RecipeCard(n);r.classList.add("search-result"),l.appendChild(r)}e.parentNode.replaceChild(l,e)}function clearResults(t){let e=t.cloneNode(!1);t.parentNode.replaceChild(e,t)}function displayCategoryFilter(){let e=[...document.querySelectorAll("#dialog-category input:checked")].map(l=>l.value);if(storeSearch("#dialog-category",e),e.length>0){let l=recipe_data.recipes.filter(n=>e.includes(n.category));displayResults(l,document.querySelector("#result-category"))}else clearResults(document.querySelector("#result-category"))}function displayCuisineFilter(){let e=[...document.querySelectorAll("#dialog-cuisine input:checked")].map(l=>l.value);if(storeSearch("#dialog-cuisine",e),e.length>0){let l=recipe_data.recipes.filter(n=>e.filter(a=>n.cuisine?.includes(a)).length>0);displayResults(l,document.querySelector("#result-cuisine"))}else clearResults(document.querySelector("#result-cuisine"))}function displayTagFilter(){let e=[...document.querySelectorAll("#dialog-tag input:checked")].map(l=>l.value);if(storeSearch("#dialog-tag",e),e.length>0){let l=recipe_data.recipes.filter(n=>e.filter(a=>n.tags?.includes(a)).length>0);displayResults(l,document.querySelector("#result-tag"))}else clearResults(document.querySelector("#result-tag"))}function displayNameFilter(){let t=document.querySelector("#search-name").value;if(storeSearch("#dialog-name",[t]),t.length>0){let l=index.search(t,20).map(n=>recipe_data.recipes[n]);displayResults(l,document.querySelector("#result-name"))}else clearResults(document.querySelector("#result-name"))}function displaySourceFilter(){let t=document.querySelector("#search-source").value;if(storeSearch("#dialog-source",[t]),t.length>0){var e=recipe_data.recipes.filter(l=>l.source.includes(t));displayResults(e,document.querySelector("#result-source"))}else clearResults(document.querySelector("#result-source"))}function addIngredientToFilter(t){let e=document.querySelector("#search-ingredients");if(t.inputType=="insertReplacementText"||t.inputType==null){let l=document.querySelector("#selected-ingredients"),n=newIngredient(e.value);n.addEventListener("change",r=>{r.preventDefault(),r.target.parentElement.remove(),displayIngredientFilter()}),l.appendChild(n),e.value="",displayIngredientFilter()}}function newIngredient(t){let e=document.querySelector(`#recipe-ingredients > option[value='${t}']`).dataset.fdcId,l=document.createElement("div");l.classList.add("checkbox");let n=document.createElement("input");n.setAttribute("type","checkbox"),n.setAttribute("value",t),n.setAttribute("id",`ingredient-${t}`),n.setAttribute("name",`ingredient-${t}`),n.setAttribute("data-fdc-id",e);let r=document.createElement("label");return r.setAttribute("for",`ingredient-${t}`),r.innerText=t+" \u2715",l.appendChild(n),l.appendChild(r),l}function displayIngredientFilter(){let e=[...document.querySelectorAll("#selected-ingredients input")].map(n=>Number(n.dataset.fdcId));if(e.length>0){var l=recipe_data.recipes.filter(n=>e.filter(a=>n.ingredients.includes(a)).length==e.length);displayResults(l,document.querySelector("#result-ingredients"))}else clearResults(document.querySelector("#result-ingredients"))}var CacheStatus=(n=>(n[n.None=0]="None",n[n.Update=1]="Update",n[n.Current=2]="Current",n))(CacheStatus||{});function checkOfflineCacheStatus(){let t=localStorage.getItem("last-update-hash");return t==null?0:document.querySelector("meta[name='update-hash']").content!=t?1:2}function cacheSite(t){let e=t.map(l=>[`/recipes/${l.slug}`,`/images/${l.slug}.webp`]).flat();e.push("/js/search_data.min.js"),e.push("/all-recipes"),e.push("/random"),caches.keys().then(l=>l[l.length-1]).then(l=>{caches.open(l).then(n=>{n.addAll(e)})}).then(()=>{let l=document.querySelector("meta[name='update-hash']");localStorage.setItem("last-update-hash",l.content),updateCacheButton()})}async function updateCacheButton(){let e=(await navigator.storage.estimate()).quota,l=Number(document.querySelector("meta[name='cache-size']").content);if(l>e)return;let n=document.querySelector("#cache-site-btn"),r=Math.ceil(l/1e6).toString(),a=checkOfflineCacheStatus();a==0?(n.innerHTML=`Cache site<br><span class="light-text">${r} MB</span>`,n.disabled=!1):a==1?(n.innerHTML=`Update cache<br><span class="light-text">${r} MB</span>`,n.disabled=!1):(n.innerHTML="Available<br>offline",n.disabled=!0)}function toggleTheme(){let t=document.querySelector("#theme-btn .light-text");t.innerText=="Auto"?applyTheme("Dark"):t.innerText=="Dark"?applyTheme("Light"):t.innerText=="Light"&&applyTheme("Auto")}function applyTheme(t){let e=document.querySelector("html"),l=document.querySelector("#theme-btn .light-text");t=="Dark"?(localStorage.setItem("light-theme","false"),e.classList.remove("light-theme"),l.innerText="Dark"):t=="Light"?(localStorage.setItem("light-theme","true"),e.classList.add("light-theme"),l.innerText="Light"):t=="Auto"&&applyAutoTheme()}function applyAutoTheme(){let t=document.querySelector("html"),e=document.querySelector("#theme-btn .light-text");e.innerText="Auto",window.matchMedia("(prefers-color-scheme: light)").matches?(localStorage.removeItem("light-theme"),t.classList.add("light-theme")):(localStorage.removeItem("light-theme"),t.classList.remove("light-theme"))}function storeSearch(t,e){sessionStorage.setItem("search-modalID",t),sessionStorage.setItem("search-values",JSON.stringify(e))}function restoreSearch(){let t=sessionStorage.getItem("search-modalID");if(t==null||t=="")return;let e=JSON.parse(sessionStorage.getItem("search-values"));if(e==null||e.length==0)return;let l=document.querySelector(t);if(l.showModal(),t=="#dialog-name"||t=="#dialog-source"){let n=l.querySelector("input");n.value=e[0],n.dispatchEvent(new Event("input"))}else{for(const n of e){let r=l.querySelector(`input[value="${n}"`);r.checked=!0}switch(t){case"#dialog-category":displayCategoryFilter();break;case"#dialog-cuisine":displayCuisineFilter();break;case"#dialog-tag":displayTagFilter();break}}}
