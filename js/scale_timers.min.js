var fractionMap={0:"",.5:"½",.333:"⅓",.666:"⅔",.25:"¼",.75:"¾",.2:"⅕",.4:"⅖",.6:"⅗",.8:"⅘",.1665:"⅙",.833:"⅚",.14285:"⅐",.125:"⅛",.375:"⅜",.625:"⅝",.875:"⅞"},convertableUnits={metric:{oz:[28,"g"],lb:[454,"g"],lbs:[454,"g"],cup:[250,"ml"],cups:[250,"ml"],pint:[568,"ml"],pints:[568,"ml"],quart:[950,"nl"],quarts:[950,"nl"]},imperial:{g:[.035,"oz"],kg:[2.2,"lbs"],ml:[.00423,"cups"],l:[4.423,"cups"]}};class TimerToast extends HTMLDivElement{constructor(t){super(),this.time=document.createElement("span"),this.progress=document.createElement("div"),this.counter=t,this.initial=t,this.displayTime(),this.time.classList.add("timer-text"),this.progress.classList.add("timer-progress"),this.progress.style.width="100%";const e=document.createElement("div");e.classList.add("timer-btns");const i=document.createElement("img");i.src="../img/timer-start.svg",i.classList.add("timer-icon");const s=document.createElement("button");s.classList.add("timer-btn"),s.addEventListener("click",(()=>{null==this.interval?(this.interval=setInterval(this.decrement.bind(this),1e3),i.src="../img/timer-reset.svg"):(this.reset(),i.src="../img/timer-start.svg")})),s.appendChild(i);const n=document.createElement("img");n.src="../img/timer-close.svg",n.classList.add("timer-icon");const a=document.createElement("button");a.classList.add("timer-btn"),a.addEventListener("click",(()=>{this.classList.add("toast-delete"),this.addEventListener("animationend",(()=>{this.parentNode.removeChild(this)}))})),a.appendChild(n),e.appendChild(s),e.appendChild(a),this.appendChild(this.time),this.appendChild(this.progress),this.appendChild(e),this.classList.add("timer")}displayTime(){let t=Math.floor(this.counter/3600),e=Math.floor(this.counter%3600/60),i=Math.floor(this.counter%60),s=t<10?"0"+t:t.toString(),n=e<10?"0"+e:e.toString(),a=i<10?"0"+i:i.toString();this.time.textContent=s+":"+n+":"+a}decrement(){this.counter>0?(this.counter--,this.displayTime(),this.progress.style.width=(100*this.counter/this.initial).toFixed(2)+"%"):(this.classList.add("timer-expired"),clearInterval(this.interval))}reset(){null!=this.interval&&(clearInterval(this.interval),this.interval=null),this.classList.remove("timer-expired"),this.counter=this.initial,this.progress.style.width="100%",this.displayTime()}}function scaleRecipe(t){highlightButtons(t.target);let e=document.querySelector(".scale-btns > .selected"),i=Number(e.innerHTML.substring(1));e=document.querySelector(".unit-btns > .selected");let s=e.innerHTML.toLowerCase();setServings(i);let n=document.querySelectorAll(".scalable");for(var a=0;a<n.length;a++){let t=i,e=n[a];if(e.hasAttribute("data-unit")){if(""==e.dataset.default)continue;let i,n=e.dataset.defaultunit,a="x"==e.dataset.default.slice(-1);if(Object.keys(convertableUnits[s]).includes(n)){let i=convertableUnits[s][n];t*=i[0],e.dataset.unit=i[1]}else e.dataset.unit=a?convertMixedUnit(s,n):e.dataset.defaultunit;if(e.dataset.default.includes("-"))i=scaleRange(e.dataset.default,t);else if(a){i=formatQuantity(Number(e.dataset.default.slice(0,-1))*t)}else{i=formatQuantity(Number(e.dataset.default)*t)}setScaledValue(e,i,a)}else{let i,n=e.nextElementSibling,a=n.dataset.unit;if(Object.keys(convertableUnits[s]).includes(a)){let e=convertableUnits[s][a];t*=e[0],n.innerHTML=e[1]}else n.innerHTML=convertMixedUnit(s,a);if(e.dataset.default.includes("-")){e.dataset.default;i=scaleRange(e.dataset.default,t)}else{i=formatQuantity(Number(e.dataset.default)*t)}setScaledValue(e,i,!1)}}}function setServings(t){let e=document.getElementById("servings"),i=e.dataset.default;i.includes("-")?e.innerHTML=scaleRange(i,t):e.innerHTML=formatQuantity(Number(i)*t)}function highlightButtons(t){let e=t.parentElement.children;for(const t of e)t.classList.remove("selected");t.classList.add("selected")}function convertMixedUnit(t,e){let i=Object.keys(convertableUnits[t]).join("|"),s=new RegExp("(?<quantity>\\d+)\\s(?<unit>"+i+")(?<extra>.*)","g").exec(e);if(s){let e=convertableUnits[t][s.groups.unit];return formatQuantity(Number(s.groups.quantity)*e[0])+" "+e[1]+s.groups.extra}return e}function setScaledValue(t,e,i){i&&(e+="x"),"quantity"in t.dataset?t.dataset.quantity=e:t.innerHTML=e}function scaleRange(t,e){let i=t.split("-"),s=Number(i[0])*e,n=Number(i[1])*e;return formatQuantity(s)+"-"+formatQuantity(n)}function formatQuantity(t){if(Number.isInteger(Number(t)))return t.toString();let e=Math.floor(t),i=Number(t%1),s=Object.keys(fractionMap).map(Number).reduce((function(t,e){return Math.abs(e-i)<Math.abs(t-i)?e:t})),n=fractionMap[s];return 0==e?n:e.toString()+n}function toggleSubtitutions(t){let e=t.target,i=e.parentElement.querySelector(".substitute-text");i.classList.toggle("hidden"),i.classList.contains("hidden")?e.src="../img/cart-fill.svg":e.src="../img/cart.svg"}function addTimerToast(){let t=Number(this.dataset.time);document.querySelector("#timers").appendChild(new TimerToast(t))}document.addEventListener("DOMContentLoaded",(()=>{var t=document.querySelectorAll(".scale-btns > button");for(const e of t)e.addEventListener("click",scaleRecipe);var e=document.querySelectorAll(".unit-btns > button");for(const t of e)t.addEventListener("click",scaleRecipe);var i=document.querySelectorAll(".substitute-icon");for(const t of i)t.addEventListener("click",toggleSubtitutions);customElements.define("timer-toast",TimerToast,{extends:"div"});var s=document.querySelectorAll(".toast-btn");for(const t of s)t.addEventListener("click",addTimerToast)}));