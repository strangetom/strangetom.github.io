var fractionMap={0:"",.5:"½",.333:"⅓",.666:"⅔",.25:"¼",.75:"¾",.2:"⅕",.4:"⅖",.6:"⅗",.8:"⅘",.1665:"⅙",.833:"⅚",.14285:"⅐",.125:"⅛",.375:"⅜",.625:"⅝",.875:"⅞"},convertableUnits={metric:{oz:[28,"g"],lb:[454,"g"],lbs:[454,"g"],cup:[250,"ml"],cups:[250,"ml"],pint:[568,"ml"],pints:[568,"ml"],quart:[950,"nl"],quarts:[950,"nl"]},imperial:{g:[.035,"oz"],kg:[2.2,"lbs"],ml:[.00423,"cups"],l:[4.423,"cups"]}};function scaleRecipe(e){highlightButtons(e.target);let t=document.querySelector(".scale-btns > .selected"),n=Number(t.innerHTML.substring(1));t=document.querySelector(".unit-btns > .selected");let a=t.innerHTML.toLowerCase();setServings(n);let r=document.querySelectorAll(".scalable");for(var l=0;l<r.length;l++){let e=n,t=r[l];if(t.hasAttribute("data-unit")){if(""==t.dataset.default)continue;let n,r=t.dataset.defaultunit,l="x"==t.dataset.default.slice(-1);if(Object.keys(convertableUnits[a]).includes(r)){let n=convertableUnits[a][r];e*=n[0],t.dataset.unit=n[1]}else t.dataset.unit=l?convertMixedUnit(a,r):t.dataset.defaultunit;if(t.dataset.default.includes("-"))n=scaleRange(t.dataset.default,e);else if(l){n=formatQuantity(Number(t.dataset.default.slice(0,-1))*e)}else{n=formatQuantity(Number(t.dataset.default)*e)}setScaledValue(t,n,l)}else{let n,r=t.nextElementSibling,l=r.dataset.unit;if(Object.keys(convertableUnits[a]).includes(l)){let t=convertableUnits[a][l];e*=t[0],r.innerHTML=t[1]}else r.innerHTML=convertMixedUnit(a,l);if(t.dataset.default.includes("-")){t.dataset.default;n=scaleRange(t.dataset.default,e)}else{n=formatQuantity(Number(t.dataset.default)*e)}setScaledValue(t,n,!1)}}}function setServings(e){let t=document.getElementById("servings"),n=t.dataset.default;n.includes("-")?t.innerHTML=scaleRange(n,e):t.innerHTML=formatQuantity(Number(n)*e)}function highlightButtons(e){let t=e.parentElement.children;for(const e of t)e.classList.remove("selected");e.classList.add("selected")}function convertMixedUnit(e,t){let n=Object.keys(convertableUnits[e]).join("|"),a=new RegExp("(?<quantity>\\d+)\\s(?<unit>"+n+")(?<extra>.*)","g").exec(t);if(a){let t=convertableUnits[e][a.groups.unit];return formatQuantity(Number(a.groups.quantity)*t[0])+" "+t[1]+a.groups.extra}return t}function setScaledValue(e,t,n){n&&(t+="x"),"quantity"in e.dataset?e.dataset.quantity=t:e.innerHTML=t}function scaleRange(e,t){let n=e.split("-"),a=Number(n[0])*t,r=Number(n[1])*t;return formatQuantity(a)+"-"+formatQuantity(r)}function formatQuantity(e){if(Number.isInteger(Number(e)))return e.toString();let t=Math.floor(e),n=Number(e%1),a=Object.keys(fractionMap).map(Number).reduce((function(e,t){return Math.abs(t-n)<Math.abs(e-n)?t:e})),r=fractionMap[a];return 0==t?r:t.toString()+r}document.addEventListener("DOMContentLoaded",(()=>{var e=document.querySelectorAll(".scale-btns > button");for(const t of e)t.addEventListener("click",scaleRecipe);var t=document.querySelectorAll(".unit-btns > button");for(const e of t)e.addEventListener("click",scaleRecipe);var n=document.querySelectorAll(".timer-wrapper"),a=Array(),r=Array(),l=Array();for(let e=0;e<n.length;e++){let t=n[e],i=t.querySelector(".timer-display");a[e]=Number(i.dataset.time),r[e]=i;let u=t.querySelector(".timer-btn");u.addEventListener("click",(()=>{u.classList.contains("timer-start")?(l[e]=setInterval(s,1e3,e),r[e].parentElement.parentElement.classList.add("timer-running"),u.classList.remove("timer-start"),u.classList.add("timer-reset")):(clearInterval(l[e]),a[e]=i.dataset.time,s(e),r[e].parentElement.parentElement.classList.remove("timer-running"),r[e].parentElement.parentElement.classList.remove("timer-complete"),u.classList.remove("timer-reset"),u.classList.add("timer-start"))})),s(e)}function s(e){let t=Math.floor(a[e]/3600),n=Math.floor(a[e]%3600/60),s=Math.floor(a[e]%60),i=t<10?"0"+t:t.toString(),u=n<10?"0"+n:n.toString(),c=s<10?"0"+s:s.toString();r[e].textContent=i+":"+u+":"+c,a[e]>0?a[e]--:(r[e].parentElement.parentElement.classList.add("timer-complete"),clearInterval(l[e]))}}));