var fractionMap={0:"",.5:"½",.333:"⅓",.666:"⅔",.25:"¼",.75:"¾",.2:"⅕",.4:"⅖",.6:"⅗",.8:"⅘",.1665:"⅙",.833:"⅚",.14285:"⅐",.125:"⅛",.375:"⅜",.625:"⅝",.875:"⅞"},convertableUnits={metric:{oz:[28,"g"],lb:[454,"g"],lbs:[454,"g"],cup:[250,"ml"],cups:[250,"ml"],pint:[568,"ml"],pints:[568,"ml"],quart:[950,"nl"],quarts:[950,"nl"]},imperial:{g:[.035,"oz"],kg:[2.2,"lbs"],ml:[.00423,"cups"],l:[4.423,"cups"]}};onload=function(){var e=document.querySelectorAll(".scale-btns > button");for(btn of e)btn.addEventListener("click",scaleRecipe);var t=document.querySelectorAll(".unit-btns > button");for(btn of t)btn.addEventListener("click",scaleRecipe);var a=document.querySelectorAll(".timer-wrapper"),n=Array(),l=Array(),r=Array();for(let e=0;e<a.length;e++){let t=a[e];n[e]=Number(t.querySelector(".timer-display").dataset.time),l[e]=t.querySelector(".timer-display");let i=t.querySelector(".timer-btn");i.addEventListener("click",(()=>{i.classList.contains("timer-start")?(r[e]=setInterval(s,1e3,e),l[e].parentElement.parentElement.classList.add("timer-running"),i.classList.remove("timer-start"),i.classList.add("timer-reset")):(clearInterval(r[e]),n[e]=t.querySelector(".timer-display").dataset.time,s(e),l[e].parentElement.parentElement.classList.remove("timer-running"),l[e].parentElement.parentElement.classList.remove("timer-complete"),i.classList.remove("timer-reset"),i.classList.add("timer-start"))})),s(e)}function s(e){let t=Math.floor(n[e]/3600),a=Math.floor(n[e]%3600/60),s=Math.floor(n[e]%60),i=t<10?"0"+t:t,c=a<10?"0"+a:a,u=s<10?"0"+s:s;l[e].textContent=i+":"+c+":"+u,n[e]>0?n[e]--:(l[e].parentElement.parentElement.classList.add("timer-complete"),clearInterval(r[e]))}},scaleRecipe=function(e){let t=e.target;highlightButtons(t);let a=document.querySelector(".scale-btns > .selected"),n=a.innerHTML.substring(1);a=document.querySelector(".unit-btns > .selected");let l=a.innerHTML.toLowerCase();setServings(n);let r=document.getElementsByClassName("scalable");for(var s=0;s<r.length;s++){let e=n,t=r[s];if(t.hasAttribute("data-unit")){if(""==t.dataset.default)continue;let a=t.dataset.defaultunit,n="x"==t.dataset.default.slice(-1);if(Object.keys(convertableUnits[l]).includes(a)){let n=convertableUnits[l][a];e*=n[0],t.dataset.unit=n[1]}else t.dataset.unit=n?convertMixedUnit(l,a):t.dataset.defaultunit;t.dataset.default.includes("-")?scaled=scaleRange(t.dataset.default,e):scaled=n?formatQuantity(t.dataset.default.slice(0,-1)*e):formatQuantity(t.dataset.default*e),setScaledValue(t,scaled,n)}else{let a=t.nextElementSibling,n=a.dataset.unit;if(Object.keys(convertableUnits[l]).includes(n)){let t=convertableUnits[l][n];e*=t[0],a.innerHTML=t[1]}else a.innerHTML=convertMixedUnit(l,n);t.dataset.default.includes("-")?scaled=scaleRange(t.dataset.default,e):scaled=formatQuantity(t.dataset.default*e),setScaledValue(t,scaled,!1)}}},setServings=function(e){let t=document.getElementById("servings"),a=t.dataset.default;a.includes("-")?t.innerHTML=scaleRange(a,e):t.innerHTML=formatQuantity(a*e)},highlightButtons=function(e){let t=e.parentElement.children;for(btn of t)btn.classList.remove("selected");e.classList.add("selected")},convertMixedUnit=function(e,t){let a=Object.keys(convertableUnits[e]).join("|"),n=new RegExp("(?<quantity>\\d+)\\s(?<unit>"+a+")(?<extra>.*)","g").exec(t);if(n){let t=convertableUnits[e][n.groups.unit];return formatQuantity(n.groups.quantity*t[0])+" "+t[1]+n.groups.extra}return t},setScaledValue=function(e,t,a){a&&(t+="x"),"quantity"in e.dataset?e.dataset.quantity=t:e.innerHTML=t},scaleRange=function(e,t){return split=e.split("-"),lower=formatQuantity(split[0]*t),upper=formatQuantity(split[1]*t),lower+"-"+upper},formatQuantity=function(e){if(Number.isInteger(Number(e)))return e;let t=Math.floor(e),a=Number(e%1);fractionValues=Object.keys(fractionMap);let n=fractionValues.reduce((function(e,t){return Math.abs(t-a)<Math.abs(e-a)?t:e})),l=fractionMap[n];return 0==t?l:t+l};