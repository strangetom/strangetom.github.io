var fractionMap={0:"",.5:"½",.333:"⅓",.666:"⅔",.25:"¼",.75:"¾",.2:"⅕",.4:"⅖",.6:"⅗",.8:"⅘",.1665:"⅙",.833:"⅚",.14285:"⅐",.125:"⅛",.375:"⅜",.625:"⅝",.875:"⅞"},convertableUnits={metric:{oz:[28,"g"],lb:[454,"g"],lbs:[454,"g"],cup:[250,"ml"],cups:[250,"ml"],pint:[568,"ml"],pints:[568,"ml"],quart:[950,"nl"],quarts:[950,"nl"]},imperial:{g:[.035,"oz"],kg:[2.2,"lbs"],ml:[.00423,"cups"],l:[4.423,"cups"]}};onload=function(){var t=document.querySelectorAll(".scale-btns > button");for(btn of t)btn.addEventListener("click",scaleRecipe);var e=document.querySelectorAll(".unit-btns > button");for(btn of e)btn.addEventListener("click",scaleRecipe)},scaleRecipe=function(t){let e=t.target;highlightButtons(e);let n=document.querySelector(".scale-btns > .selected"),a=n.innerHTML.substring(1);n=document.querySelector(".unit-btns > .selected");let l=n.innerHTML.toLowerCase();setServings(a);let s=document.getElementsByClassName("scalable");for(var i=0;i<s.length;i++){let t=a,e=s[i];if(e.hasAttribute("data-unit")){if(""==e.dataset.default)continue;let n=e.dataset.defaultunit,a="x"==e.dataset.default.slice(-1);if(Object.keys(convertableUnits[l]).includes(n)){let a=convertableUnits[l][n];t*=a[0],e.dataset.unit=a[1]}else e.dataset.unit=a?convertMixedUnit(l,n):e.dataset.defaultunit;e.dataset.default.includes("-")?scaled=scaleRange(e.dataset.default,t):scaled=a?formatQuantity(e.dataset.default.slice(0,-1)*t):formatQuantity(e.dataset.default*t),setScaledValue(e,scaled,a)}else{let n=e.nextElementSibling,a=n.dataset.unit;if(Object.keys(convertableUnits[l]).includes(a)){let e=convertableUnits[l][a];t*=e[0],n.innerHTML=e[1]}else n.innerHTML=convertMixedUnit(l,a);e.dataset.default.includes("-")?scaled=scaleRange(e.dataset.default,t):scaled=formatQuantity(e.dataset.default*t),setScaledValue(e,scaled,!1)}}},setServings=function(t){let e=document.getElementById("servings"),n=e.dataset.default;n.includes("-")?e.innerHTML=scaleRange(n,t):e.innerHTML=formatQuantity(n*t)},highlightButtons=function(t){let e=t.parentElement.children;for(btn of e)btn.classList.remove("selected");t.classList.add("selected")},convertMixedUnit=function(t,e){let n=Object.keys(convertableUnits[t]).join("|"),a=new RegExp("(?<quantity>\\d+)\\s(?<unit>"+n+")(?<extra>.*)","g").exec(e);if(a){let e=convertableUnits[t][a.groups.unit];return formatQuantity(a.groups.quantity*e[0])+" "+e[1]+a.groups.extra}return e},setScaledValue=function(t,e,n){n&&(e+="x"),"quantity"in t.dataset?t.dataset.quantity=e:t.innerHTML=e},scaleRange=function(t,e){return split=t.split("-"),lower=formatQuantity(split[0]*e),upper=formatQuantity(split[1]*e),lower+"-"+upper},formatQuantity=function(t){if(Number.isInteger(Number(t)))return t;let e=Math.floor(t),n=Number(t%1);fractionValues=Object.keys(fractionMap);let a=fractionValues.reduce((function(t,e){return Math.abs(e-n)<Math.abs(t-n)?e:t})),l=fractionMap[a];return 0==e?l:e+l};