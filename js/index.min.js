"use strict";document.addEventListener("DOMContentLoaded",()=>{let e=document.querySelector("button#sidebar"),a=document.querySelector("nav"),t=document.querySelector("main");e.addEventListener("click",s=>{a.style.transform===""||a.style.transform==="translateX(0px)"?(a.style.transform="translateX(-250px)",t.style.transform="translateX(-250px)"):(a.style.transform="translateX(0px)",t.style.transform="translateX(0px)")}),updateCacheButton(),document.querySelector("#cache-site-btn").addEventListener("click",()=>{cacheSite(recipe_data.recipes)});let n=document.querySelector("#theme-btn");n.disabled=!1,n.addEventListener("click",toggleTheme);let r=localStorage.getItem("light-theme");r==null?applyTheme("Auto"):r=="true"?applyTheme("Light"):applyTheme("Dark")});var CacheStatus=(l=>(l[l.None=0]="None",l[l.Update=1]="Update",l[l.Current=2]="Current",l))(CacheStatus||{});function checkOfflineCacheStatus(){let e=localStorage.getItem("last-update-hash");return e==null?0:document.querySelector("meta[name='update-hash']").content!=e?1:2}function cacheSite(e){let a=e.map(t=>[`/recipes/${t.slug}`,`/images/${t.slug}.webp`]).flat();a.push("/js/search_data.min.js"),a.push("/all-recipes"),a.push("/top-recipes"),caches.keys().then(t=>t[t.length-1]).then(t=>{caches.open(t).then(l=>{l.addAll(a)})}).then(()=>{let t=document.querySelector("meta[name='update-hash']");localStorage.setItem("last-update-hash",t.content),updateCacheButton()})}async function updateCacheButton(){let a=(await navigator.storage.estimate()).quota,t=Number(document.querySelector("meta[name='cache-size']").content);if(t>a)return;let l=document.querySelector("#cache-site-btn"),n=Math.ceil(t/1e6).toString(),r=checkOfflineCacheStatus();r==0?(l.innerHTML=`Cache site<span class="light-text">${n} MB</span>`,l.disabled=!1):r==1?(l.innerHTML=`Update cache<span class="light-text">${n} MB</span>`,l.disabled=!1):(l.innerHTML="Available offline",l.disabled=!0)}function toggleTheme(){let e=document.querySelector("#theme-btn .light-text");e.innerText=="Auto"?applyTheme("Dark"):e.innerText=="Dark"?applyTheme("Light"):e.innerText=="Light"&&applyTheme("Auto")}function applyTheme(e){let a=document.querySelector("html"),t=document.querySelector("#theme-btn .light-text");e=="Dark"?(localStorage.setItem("light-theme","false"),a.classList.remove("light-theme"),t.innerText="Dark"):e=="Light"?(localStorage.setItem("light-theme","true"),a.classList.add("light-theme"),t.innerText="Light"):e=="Auto"&&applyAutoTheme()}function applyAutoTheme(){let e=document.querySelector("html"),a=document.querySelector("#theme-btn .light-text");a.innerText="Auto",window.matchMedia("(prefers-color-scheme: light)").matches?(localStorage.removeItem("light-theme"),e.classList.add("light-theme")):(localStorage.removeItem("light-theme"),e.classList.remove("light-theme"))}
